---
title: "exactt"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{exactt}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE,
                      comment  = "#>")
```

# Introduction

The `exactt` package computes a $(1-\alpha)\%$ confidence interval for coefficients in a linear model using the method described in Pouliot (2023). 

# Installation

`exactt` is hosted on GitHub at https://github.com/ian-xu-economics/exactt/. It can be installed using the install_github() function in the remotes package:
``` r
# install.packages("remotes")
remotes::install_github("ian-xu-economics/exactt")
```

# Attribution

Citing the `exactt` package is convenient. The text version and BibTeX entry are provided by:
``` r
citation("exactt")
```

# Attaching `exactt`

After installing `exactt`, we can attach the package to our session using the base `library()` function:
```{r echo = F, message = F, warning = F}
library("exactt")
```

# An Exact $t$-Test

The main function to compute the  $(1-\alpha)\%$ confidence interval is `exactt()`. It is very flexible and provides much customization. To see all that `exactt()` provides, it is best to run it on some examples. 

# Illustration: Regress `Wind` on `Temp` and `Month`.

To demonstrate the *exactt* package, we use data of daily air quality measurements in New York found in `datasets::airquality`. We'll  investigate the relationship between temperature (degrees F) and month (1--12) on wind (mph). 
```{r}
summary(datasets::airquality[c("Wind", "Temp", "Month")])
```

We can plug in standard formula notation into `exactt()`. If we don't specify any additional parameters, then by default:

* The number of blocks used equals 5 (`nBlocks = 5`).
* The confidence interval is constructed for all variables (`variables = NULL`).
* The number of permutations is equal to  (`nPerms = factorial(nBlocks)`).
* The level of significance equals 0.05 (`alpha = 0.05`). 
* The test statistics are studentized (`studentize = TRUE`).
* The ordering of the data is not permuted (`permutation = NULL`).
* The ordering of the data is not optimized (`optimize = FALSE`).
```{r}
exactt1 <- exactt(Wind ~ Temp + Month,
                  data = datasets::airquality)
exactt1
```

If *tidyverse*, *latex2exp* are installed, we can also plug in the result from calling `exactt()` into the `exacttPlot()` function, which plots the p-value against $\beta^0$. 
```{r}
exacttPlot(exactt1)
```

## Interest in Coefficients for Specific Variables

Suppose we are only interested in the coefficient on the first variable (Temp), then we can set `variables` equal to 1. Likewise, if we are interested in the coefficient on the second variable (Month), then we can set `variables` equal to 2. 
```{r}
exactt2 <- exactt(Wind ~ Temp + Month,
                  data = datasets::airquality,
                  variables = 1)

exactt2
```
Note that the 95% confidence interval is equal to the case where all variables are of interest because these confidence intervals are marginally valid.

## Optimizing the Ordering

The confidence interval generated using the `exactt()` function is dependent on the ordering of the data. Some orderings will achieve better power on average than other orderings. Furthermore, when sample size is small, and the number of blocks is large, optimization will have a larger effect on average. `exactt()` uses the genetic algorithm via the GA algorithm to find the best ordering on average. We only look at the X variables.

If optimization is desired, we can set `optimize` to `TRUE`. We can also pass through whatever other parameters that the `GA::ga()` function normally accepts. For instance, we can set `maxiter = 10`, and `seed = 2024`. Note that if optimize is `FALSE` and the other parameters are still passed through, optimization will _not_ be performed.

```{r}
exactt3 <- exactt(Wind ~ Temp + as.factor(Month),
                  data = datasets::airquality,
                  variables = 1,
                  optimize = TRUE,
                  maxiter = 1,
                  seed = 2024)

exactt3
```
If the output from running the `GA::ga()` function is not desired, we can set `monitor = FALSE`.

It is important to remember that optimizing only increases power on average since we optimize the ordering of the data based on the regressors. It is possible that for any singular case, optimizing the ordering of the data increases the width of the confidence interval compared to the original order.




